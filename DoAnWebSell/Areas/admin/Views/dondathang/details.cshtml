@model IEnumerable<Model.EF.ChiTietDatHang>

@{
    ViewBag.Title = "Chi tiết đơn hàng";
    Layout = "~/Areas/admin/Views/Shared/_Layouts.cshtml";
    int i = 0;
    decimal sum = 0;
}

@section header {
    Chi tiết đơn hàng
}

<div class="card-body">
    <div class="table-responsive">
        <table class="table table-bordered" cellspacing="0">
            <thead>
                <tr>
                    <th>Mã đơn</th>
                    <th>Người đặt</th>
                    <th>Địa chỉ giao</th>
                    <th>Số điện thoại</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>@item.DonDatHang.MaDon</td>
                        <td>@item.DonDatHang.TenNguoiDat</td>
                        <td>@item.DonDatHang.DiaChiGiaoHang</td>
                        <td>@item.DonDatHang.SoDienThoai</td>
                    </tr>
                    break;
                }
            </tbody>
        </table>
    </div>
</div>

<div class="card-body">
    <div class="table-responsive">
        <table class="table table-bordered" cellspacing="0">
            <thead>
                <tr style="text-align: center;">
                    <th width="5%">STT</th>
                    <th width="14%">Ảnh</th>
                    <th>Sản phẩm</th>
                    <th width="9%">Số lượng</th>
                    <th width="17%">Đơn giá</th>
                    <th width="17%">Thành tiền</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td style="text-align: center;">
                            @{ i++; }
                            @i
                        </td>
                        <td style="text-align: center;"><img src="/assets/client/images/@item.SanPham.HinhAnh" width="70" /></td>
                        <td style="font-weight:bold; color:#337ab7;">@item.SanPham.TenSP</td>
                        <td style="text-align: center;">@item.SoLuong</td>
                        
                        @if (item.DonGia == null)
                        {
                            <td style="text-align: center;">Liên hệ khách hàng</td>
                        }
                        else
                        {
                            <td style="text-align: center;">@String.Format("{0:0,0}", item.DonGia) ₫</td>
                        }
                        
                        @if (item.DonGia == null)
                        {
                            <td style="text-align: center;">Liên hệ khách hàng</td>
                        }
                        else
                        {
                            <td style="text-align: center;">@String.Format("{0:0,0}", item.DonGia.GetValueOrDefault(0) * item.SoLuong) ₫</td>
                        }                
                    </tr>
                    //Tính tổng tiền
                    sum += decimal.Parse((string)(item.DonGia.GetValueOrDefault(0) * item.SoLuong).ToString());
                }
            </tbody>

            <thead>
                <tr>
                    <th colspan="5" style="border: none; background-color: #FFF"></th>
                    <th style="text-align: center;">Tổng tiền</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td colspan="5" style="border: none"></td>
                    @if (sum == 0)
                    {
                        <td style="text-align: center;">0</td>
                    }
                    else
                    {
                        <td style="text-align: center;">@sum.ToString("0#,##0") ₫</td>
                    }        
                </tr>
            </tbody>

        </table>
    </div>
</div>
